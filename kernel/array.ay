use("core")
use("define")
use("undefined")
use("control-flow")

macro(~x for(~e) in(~c)):
  `(~c collect [~e]: ~x)

macro(~x for(~e) in(~c) if(~t)):
  names [tmp]:
    `(do:
        ~tmp = []
        ~c collect [~e]:
          when(~t):
            ~tmp << ~x

        ~tmp)

Array inject-right(i = _undefined) &block :=
  reverse inject(i) [x, y]: block [y, x]

.infix right 5 .

macro(~a . ~b): `([~a] + ~b)
